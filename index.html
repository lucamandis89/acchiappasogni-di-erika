<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Acchiappasogni di Erika â€” Catalogo</title>
  <style>
    :root{
      --bg:#0b1027;
      --panel:#0f1636;
      --card:#111a3f;
      --line:rgba(255,255,255,.10);
      --text:#eef2ff;
      --muted:#b9c3ff;
      --accent:#7c5cff;
      --accent2:#2dd4bf;
      --shadow:0 12px 40px rgba(0,0,0,.35);
      --r:16px;
      --r2:22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 900px at 20% -10%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(1200px 900px at 110% 10%, rgba(45,212,191,.22), transparent 55%),
        var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      text-rendering:optimizeLegibility;
    }
    header{
      position:sticky; top:0; z-index:20;
      padding:12px 12px 10px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(11,16,39,.92), rgba(11,16,39,.60));
      backdrop-filter: blur(12px);
    }
    .top{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
    .brand{
      display:flex; flex-direction:column; gap:4px; min-width:0;
    }
    .brand h1{
      margin:0; font-size:14px; font-weight:900; letter-spacing:.2px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand .sub{
      font-size:12px; color:var(--muted); display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .btn{
      border:none; cursor:pointer;
      padding:10px 12px; border-radius:12px;
      font-weight:900; font-size:13px; color:var(--text);
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      user-select:none;
      transition: transform .06s ease, background .15s ease;
      display:inline-flex; align-items:center; gap:8px;
    }
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(124,92,255,.95), rgba(45,212,191,.55));
      border-color: rgba(255,255,255,.16);
    }
    .btn.ghost{background:transparent}
    .badge{
      display:inline-grid; place-items:center;
      min-width:22px; height:22px; padding:0 6px;
      border-radius:999px; font-weight:1000;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.28);
      color:var(--text);
      font-size:12px;
    }

    main{padding:12px; display:grid; gap:12px}
    .searchRow{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    input[type="search"]{
      flex:1 1 260px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color:var(--text);
      font-weight:800;
      outline:none;
    }
    .chips{display:flex; gap:8px; flex-wrap:wrap;}
    .chip{
      padding:9px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color:var(--text);
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      user-select:none;
    }
    .chip.on{
      background: rgba(124,92,255,.22);
      border-color: rgba(124,92,255,.45);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:12px;
    }
    @media (min-width: 860px){
      .grid{grid-template-columns: repeat(3, minmax(0, 1fr));}
    }
    .card{
      border:1px solid var(--line);
      border-radius: var(--r2);
      background: linear-gradient(180deg, rgba(17,26,63,.55), rgba(15,22,54,.55));
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }
    .img{
      aspect-ratio: 4 / 3;
      background: rgba(255,255,255,.06);
      display:grid;
      place-items:center;
      overflow:hidden;
    }
    .img img{
      width:100%; height:100%; object-fit:cover; display:block;
    }
    .img .ph{
      color:rgba(255,255,255,.55);
      font-weight:900;
      font-size:12px;
      padding:16px;
      text-align:center;
    }
    .cbody{padding:10px 10px 12px; display:grid; gap:10px;}
    .title{margin:0; font-weight:1000; font-size:13px; line-height:1.2;}
    .meta{margin:0; color:var(--muted); font-size:11px;}
    .price{font-weight:1000; font-size:13px;}
    .qtyRow{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .qty{
      display:flex; align-items:center; gap:8px;
    }
    .qbtn{
      width:34px; height:34px; border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color:var(--text);
      font-weight:1000;
      cursor:pointer;
    }
    .qnum{min-width:18px; text-align:center; font-weight:1000;}
    .footerBar{
      position:sticky; bottom:0; z-index:30;
      padding:10px 12px;
      border-top:1px solid var(--line);
      background: linear-gradient(180deg, rgba(15,22,54,.0), rgba(15,22,54,.86));
      backdrop-filter: blur(10px);
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .small{font-size:12px; color:var(--muted); font-weight:900;}
    .sum{font-weight:1000}
  </style>
</head>

<body>
<header>
  <div class="top">
    <div class="brand">
      <h1>Acchiappasogni di Erika</h1>
      <div class="sub">
        <span>Catalogo â€¢ Ordina su WhatsApp</span>
      </div>
    </div>

    <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
      <button class="btn primary" id="goCustomizer">âœ¨ CREA IL TUO ACCHIAPPASOGNI</button>
      <button class="btn ghost" id="goCart">ðŸ›’ Carrello <span class="badge" id="cartBadge">0</span></button>
    </div>
  </div>

  <div class="searchRow" style="margin-top:10px">
    <input id="search" type="search" placeholder="Cerca (nome o descrizione)â€¦" />
    <div class="chips" id="chips"></div>
  </div>
</header>

<main>
  <div class="grid" id="grid"></div>
</main>

<div class="footerBar">
  <div class="small">
    Totale carrello: <span class="sum" id="cartTotal">0,00â‚¬</span>
  </div>
  <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
    <button class="btn" id="btnClear">ðŸ§¹ Svuota</button>
    <button class="btn primary" id="btnWhatsApp">ðŸ’¬ Ordina su WhatsApp</button>
  </div>
</div>

<script>
  // ===== CONFIG =====
  const STORAGE_CART = "ery_cart_v1";
  // Metti qui il numero WhatsApp (con prefisso paese, senza +)
  // Esempio Italia: 393440260906
  const WA_NUMBER = ""; // <-- se vuoi lo imposto tu: scrivi qui il numero

  const CATEGORIES = ["Tutti","Acchiappasogni Classici","Natale","Nascita","Matrimonio"];

  // Prodotti esempio (puoi cambiare immagini e nomi quando vuoi)
  // Per le immagini: usa URL oppure lascia vuoto per placeholder.
  const PRODUCTS = [
    { id:"m3",  name:"Acchiappasogni - Modello 3",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m4",  name:"Acchiappasogni - Modello 4",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m5",  name:"Acchiappasogni - Modello 5",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m6",  name:"Acchiappasogni - Modello 6",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m7",  name:"Acchiappasogni - Modello 7",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m8",  name:"Acchiappasogni - Modello 8",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m9",  name:"Acchiappasogni - Modello 9",  cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m31", name:"Acchiappasogni - Modello 31", cat:"Natale", price:5.00, img:"" },
    { id:"m32", name:"Acchiappasogni - Modello 32", cat:"Acchiappasogni Classici", price:5.00, img:"" },
    { id:"m33", name:"Acchiappasogni - Modello 33", cat:"Natale", price:5.00, img:"" },
    { id:"m34", name:"Acchiappasogni - Modello 34", cat:"Natale", price:5.00, img:"" },
    { id:"m35", name:"Acchiappasogni - Modello 35", cat:"Natale", price:5.00, img:"" },
  ];

  // ===== STATE =====
  let currentCat = "Tutti";
  let q = "";
  let cart = loadCart();

  // ===== HELPERS =====
  function euro(n){
    const s = (Math.round(n*100)/100).toFixed(2).replace(".", ",");
    return s + "â‚¬";
  }
  function loadCart(){
    try{ return JSON.parse(localStorage.getItem(STORAGE_CART) || "{}"); }
    catch(e){ return {}; }
  }
  function saveCart(){
    localStorage.setItem(STORAGE_CART, JSON.stringify(cart));
  }
  function cartCount(){
    return Object.values(cart).reduce((a,b)=>a+b,0);
  }
  function cartTotal(){
    let t = 0;
    for(const [id, qty] of Object.entries(cart)){
      const p = PRODUCTS.find(x=>x.id===id);
      if(p) t += p.price * qty;
    }
    return t;
  }

  // ===== UI RENDER =====
  const chipsEl = document.getElementById("chips");
  const gridEl = document.getElementById("grid");

  function renderChips(){
    chipsEl.innerHTML = "";
    CATEGORIES.forEach(cat=>{
      const d = document.createElement("div");
      d.className = "chip" + (cat===currentCat ? " on" : "");
      d.textContent = cat;
      d.onclick = ()=>{ currentCat = cat; renderAll(); };
      chipsEl.appendChild(d);
    });
  }

  function filteredProducts(){
    return PRODUCTS.filter(p=>{
      const okCat = (currentCat==="Tutti") || (p.cat===currentCat);
      const text = (p.name + " " + (p.cat||"")).toLowerCase();
      const okQ = !q || text.includes(q);
      return okCat && okQ;
    });
  }

  function renderGrid(){
    const items = filteredProducts();
    gridEl.innerHTML = "";

    items.forEach(p=>{
      const qty = cart[p.id] || 0;

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="img">
          ${
            p.img
              ? `<img src="${p.img}" alt="${p.name}">`
              : `<div class="ph">Immagine non trovata</div>`
          }
        </div>
        <div class="cbody">
          <div>
            <p class="title">${p.name}</p>
            <p class="meta">${p.cat}</p>
          </div>
          <div class="qtyRow">
            <div>
              <div class="price">${euro(p.price)}</div>
            </div>
            <div class="qty">
              <button class="qbtn" data-a="minus" data-id="${p.id}">-</button>
              <div class="qnum" id="q_${p.id}">${qty}</div>
              <button class="qbtn" data-a="plus" data-id="${p.id}">+</button>
            </div>
          </div>
          <button class="btn primary" data-a="add" data-id="${p.id}">Aggiungi</button>
        </div>
      `;

      card.addEventListener("click", (e)=>{
        const btn = e.target.closest("[data-a]");
        if(!btn) return;
        const id = btn.dataset.id;
        const a = btn.dataset.a;

        if(a==="minus"){
          cart[id] = Math.max(0, (cart[id]||0)-1);
          if(cart[id]===0) delete cart[id];
        } else if(a==="plus" || a==="add"){
          cart[id] = (cart[id]||0) + 1;
        }
        saveCart();
        updateCartUI();
        const qn = document.getElementById("q_"+id);
        if(qn) qn.textContent = cart[id] || 0;
        e.stopPropagation();
      });

      gridEl.appendChild(card);
    });

    if(items.length===0){
      gridEl.innerHTML = `<div style="color:var(--muted); font-weight:900">Nessun prodotto trovato.</div>`;
    }
  }

  function updateCartUI(){
    document.getElementById("cartBadge").textContent = cartCount();
    document.getElementById("cartTotal").textContent = euro(cartTotal());
  }

  // ===== ACTIONS =====
  document.getElementById("search").addEventListener("input", (e)=>{
    q = (e.target.value || "").trim().toLowerCase();
    renderGrid();
  });

  document.getElementById("btnClear").onclick = ()=>{
    if(!confirm("Svuotare il carrello?")) return;
    cart = {};
    saveCart();
    renderGrid();
    updateCartUI();
  };

  document.getElementById("btnWhatsApp").onclick = ()=>{
    if(cartCount()===0){
      alert("Il carrello Ã¨ vuoto.");
      return;
    }
    const lines = [];
    lines.push("Ciao! ðŸ˜Š Vorrei ordinare questi acchiappasogni:");
    for(const [id, qty] of Object.entries(cart)){
      const p = PRODUCTS.find(x=>x.id===id);
      if(p) lines.push(`- ${p.name} x${qty} (${euro(p.price)})`);
    }
    lines.push(`Totale: ${euro(cartTotal())}`);
    lines.push("Grazie! ðŸ™");

    const msg = encodeURIComponent(lines.join("\n"));

    // se non hai messo il numero, apre WhatsApp senza numero (condividi manualmente)
    const url = WA_NUMBER
      ? `https://wa.me/${WA_NUMBER}?text=${msg}`
      : `https://wa.me/?text=${msg}`;

    window.open(url, "_blank");
  };

  // QUI: apre SOLO il configuratore
  document.getElementById("goCustomizer").onclick = ()=>{
    window.location.href = "configuratore.html";
  };

  // carrello button (solo scroll su fondo, semplice)
  document.getElementById("goCart").onclick = ()=>{
    window.scrollTo({ top: document.body.scrollHeight, behavior:"smooth" });
  };

  // INIT
  renderChips();
  renderGrid();
  updateCartUI();
</script>
</body>
</html>
